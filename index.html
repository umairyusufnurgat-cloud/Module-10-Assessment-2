<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Culinary Canvas - Recipe Book</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            color: #333;
        }

        .app-container {
            min-height: 100vh;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            padding: 1.5rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 2rem;
        }

        .logo {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(45deg, #ff6b6b, #feca57, #48dbfb, #ff9ff3);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradientShift 4s ease-in-out infinite;
        }

        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .search-container {
            display: flex;
            flex: 1;
            max-width: 500px;
            position: relative;
        }

        .search-container input {
            flex: 1;
            padding: 1rem 1.5rem;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.9);
            font-size: 1rem;
            outline: none;
            transition: all 0.3s ease;
        }

        .search-container input:focus {
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }

        .search-btn {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
            padding: 0.8rem 1.2rem;
            border-radius: 20px;
            color: white;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .search-btn:hover {
            transform: translateY(-50%) scale(1.05);
        }

        .add-recipe-btn {
            background: linear-gradient(45deg, #ff6b6b, #feca57);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.3);
        }

        .add-recipe-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(255, 107, 107, 0.4);
        }

        .category-nav {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 1rem 0;
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .category-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .category-btn:hover,
        .category-btn.active {
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 3rem 2rem;
        }

        .recipes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 2rem;
        }

        .recipe-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            transition: all 0.4s ease;
            cursor: pointer;
            position: relative;
        }

        .recipe-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
        }

        .recipe-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
            transition: transform 0.4s ease;
        }

        .recipe-card:hover .recipe-image {
            transform: scale(1.1);
        }

        .recipe-info {
            padding: 1.5rem;
        }

        .recipe-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 0.8rem;
            color: #2c3e50;
        }

        .recipe-meta {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            font-size: 0.9rem;
            color: #7f8c8d;
            background: rgba(103, 126, 234, 0.1);
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
        }

        .recipe-preview {
            color: #7f8c8d;
            font-size: 0.9rem;
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .difficulty-easy { color: #27ae60; }
        .difficulty-medium { color: #f39c12; }
        .difficulty-hard { color: #e74c3c; }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 9999;
            display: none;
        }

        .modal[style*="block"] {
            display: block !important;
        }

        .modal-content {
            background: white;
            border-radius: 25px;
            max-width: 900px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            position: absolute;
            left: 50%;
            transform: translateX(-50%) scale(0.3);
            opacity: 0;
            transition: all 0.3s ease;
            margin: 2rem 0;
        }

        .modal[style*="block"] .modal-content {
            transform: translateX(-50%) scale(1);
            opacity: 1;
        }

        .close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 10;
            transition: background 0.3s ease;
        }

        .close-btn:hover {
            background: rgba(0, 0, 0, 0.7);
        }

        .recipe-hero {
            position: relative;
            height: 400px;
            overflow: hidden;
        }

        .recipe-hero img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .recipe-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
            color: white;
            padding: 2rem;
        }

        .recipe-overlay h2 {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .recipe-content {
            padding: 2rem;
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 3rem;
        }

        .ingredients-section h3,
        .instructions-section h3 {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            color: #2c3e50;
        }

        .ingredients-section ul {
            list-style: none;
        }

        .ingredients-section li {
            padding: 0.8rem 0;
            border-bottom: 1px solid #ecf0f1;
            position: relative;
            padding-left: 2rem;
        }

        .ingredients-section li::before {
            content: 'ü•Ñ';
            position: absolute;
            left: 0;
        }

        .instructions-section ol {
            counter-reset: step-counter;
            list-style: none;
        }

        .instructions-section li {
            counter-increment: step-counter;
            padding: 1rem 0;
            border-bottom: 1px solid #ecf0f1;
            position: relative;
            padding-left: 3rem;
        }

        .instructions-section li::before {
            content: counter(step-counter);
            position: absolute;
            left: 0;
            top: 1rem;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            width: 2rem;
            height: 2rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .recipe-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            padding: 2rem;
            border-top: 1px solid #ecf0f1;
        }

        .edit-recipe-btn {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(52, 152, 219, 0.3);
        }

        .edit-recipe-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(52, 152, 219, 0.4);
        }

        .delete-recipe-btn {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(231, 76, 60, 0.3);
        }

        .delete-recipe-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(231, 76, 60, 0.4);
        }

        .add-recipe-form {
            padding: 2rem;
            max-width: 600px;
        }

        .add-recipe-form h2 {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            margin-bottom: 2rem;
            text-align: center;
            color: #2c3e50;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #2c3e50;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 1rem;
            border: 2px solid #ecf0f1;
            border-radius: 10px;
            font-family: inherit;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .submit-btn {
            width: 100%;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 1.2rem;
            border-radius: 15px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
        }

        .image-input-container {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .image-input-container input[type="file"] {
            padding: 0.8rem;
            border: 2px dashed #667eea;
            border-radius: 10px;
            background: rgba(102, 126, 234, 0.05);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .image-input-container input[type="file"]:hover {
            border-color: #764ba2;
            background: rgba(118, 75, 162, 0.05);
        }

        .image-preview {
            text-align: center;
            padding: 0.5rem;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 10px;
            border: 1px solid #e9ecef;
        }

        @media (max-width: 480px) {
            .recipes-grid {
                grid-template-columns: 1fr !important;
                gap: 1rem;
                padding: 0;
            }
            
            .recipe-card {
                margin: 0;
                width: 100%;
                min-width: unset;
            }
        }
        
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1rem;
                padding: 0 1rem;
            }
            
            .logo {
                font-size: 1.5rem;
            }
            
            .search-container {
                max-width: 100%;
            }
            
            .category-nav {
                padding: 0.5rem;
                gap: 0.5rem;
            }
            
            .category-btn {
                padding: 0.6rem 1rem;
                font-size: 0.9rem;
            }
            
            .main-content {
                padding: 1rem;
            }
            
            .recipes-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
                padding: 0 0.5rem;
            }
            
            .recipe-card {
                margin: 0;
                width: 100%;
            }
            
            .modal-content {
                width: 95%;
                margin: 0.5rem;
                max-height: 95vh;
            }
            
            .modal {
                padding: 0.5rem;
            }
            
            .recipe-content {
                grid-template-columns: 1fr;
                gap: 1.5rem;
                padding: 1rem;
            }
            
            .recipe-hero {
                height: 250px;
            }
            
            .recipe-overlay h2 {
                font-size: 1.5rem;
            }
            
            .recipe-meta {
                flex-wrap: wrap;
                gap: 0.5rem;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .add-recipe-form {
                padding: 1.5rem;
            }
            
            .recipe-actions {
                flex-direction: column;
                gap: 0.8rem;
                padding: 1.5rem;
            }
            
            .edit-recipe-btn,
            .delete-recipe-btn {
                width: 100%;
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="header">
            <div class="header-content">
                <h1 class="logo">üç≥ Culinary Canvas</h1>
                <div class="search-container">
                    <input type="text" id="searchInput" placeholder="Search recipes, ingredients..." />
                    <button class="search-btn">üîç</button>
                </div>
                <button class="add-recipe-btn" onclick="showAddRecipe()">+ Add Recipe</button>
            </div>
        </header>

        <nav class="category-nav">
            <button class="category-btn active" onclick="filterRecipes('all')">All</button>
            <button class="category-btn" onclick="filterRecipes('breakfast')">ü•û Breakfast</button>
            <button class="category-btn" onclick="filterRecipes('lunch')">ü•ó Lunch</button>
            <button class="category-btn" onclick="filterRecipes('dinner')">üçΩÔ∏è Dinner</button>
            <button class="category-btn" onclick="filterRecipes('dessert')">üç∞ Dessert</button>
            <button class="category-btn" onclick="filterRecipes('snack')">üçø Snacks</button>
        </nav>

        <main class="main-content">
            <div class="recipes-grid" id="recipesGrid">
                <!-- Recipes will be populated by JavaScript -->
            </div>
        </main>

        <!-- Recipe Detail Modal -->
        <div class="modal" id="recipeModal" style="display: none;">
            <div class="modal-content recipe-detail">
                <button class="close-btn" onclick="closeRecipeModal()">&times;</button>
                <div class="recipe-hero">
                    <img id="modalImage" src="" alt="Recipe">
                    <div class="recipe-overlay">
                        <h2 id="modalTitle"></h2>
                        <div class="recipe-meta">
                            <span id="modalTime"></span>
                            <span id="modalDifficulty"></span>
                            <span id="modalServings"></span>
                        </div>
                    </div>
                </div>
                <div class="recipe-content">
                    <div class="ingredients-section">
                        <h3>ü•Ñ Ingredients</h3>
                        <ul id="modalIngredients"></ul>
                    </div>
                    <div class="instructions-section">
                        <h3>üë©üç≥ Instructions</h3>
                        <ol id="modalInstructions"></ol>
                    </div>
                    <div class="recipe-actions">
                        <button class="edit-recipe-btn" onclick="editRecipe()">‚úèÔ∏è Edit Recipe</button>
                        <button class="delete-recipe-btn" onclick="deleteRecipe()">üóëÔ∏è Delete Recipe</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add Recipe Modal -->
        <div class="modal" id="addRecipeModal" style="display: none;">
            <div class="modal-content add-recipe-form">
                <button class="close-btn" onclick="hideAddRecipe()">&times;</button>
                <h2>Create New Recipe</h2>
                <form id="recipeForm">
                    <div class="form-group">
                        <label>Recipe Name</label>
                        <input type="text" id="recipeName" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Category</label>
                            <select id="recipeCategory" required>
                                <option value="">Select Category</option>
                                <option value="breakfast">Breakfast</option>
                                <option value="lunch">Lunch</option>
                                <option value="dinner">Dinner</option>
                                <option value="dessert">Dessert</option>
                                <option value="snack">Snack</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Cooking Time</label>
                            <input type="text" id="recipeTime" placeholder="e.g., 30 mins" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Difficulty</label>
                            <select id="recipeDifficulty" required>
                                <option value="">Select Difficulty</option>
                                <option value="Easy">Easy</option>
                                <option value="Medium">Medium</option>
                                <option value="Hard">Hard</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Servings</label>
                            <input type="number" id="recipeServings" min="1" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Recipe Image</label>
                        <div class="image-input-container">
                            <input type="file" id="recipeImageFile" accept="image/*" onchange="handleImageUpload(event)">
                            <input type="url" id="recipeImage" placeholder="Or paste image URL" style="margin-top: 0.5rem;">
                        </div>
                        <div class="image-preview" id="imagePreview" style="display: none;">
                            <img id="previewImg" src="" alt="Preview" style="max-width: 200px; max-height: 150px; border-radius: 10px; margin-top: 0.5rem;">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Ingredients (one per line)</label>
                        <textarea id="recipeIngredients" rows="5" placeholder="1 cup flour&#10;2 eggs&#10;1/2 cup milk" required></textarea>
                    </div>
                    <div class="form-group">
                        <label>Instructions (one step per line)</label>
                        <textarea id="recipeInstructions" rows="6" placeholder="Preheat oven to 350¬∞F&#10;Mix dry ingredients&#10;Add wet ingredients" required></textarea>
                    </div>
                    <button type="submit" class="submit-btn">Create Recipe</button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Sample recipe data
        let recipes = JSON.parse(localStorage.getItem('recipes')) || [
            {
                id: 1,
                name: 'Classic Chocolate Chip Cookies',
                category: 'dessert',
                time: '25 mins',
                difficulty: 'Easy',
                servings: 24,
                image: 'https://images.unsplash.com/photo-1499636136210-6f4ee915583e?w=600&h=400&fit=crop',
                ingredients: [
                    '2¬º cups all-purpose flour',
                    '1 tsp baking soda',
                    '1 tsp salt',
                    '1 cup butter, softened',
                    '¬æ cup granulated sugar',
                    '¬æ cup brown sugar',
                    '2 large eggs',
                    '2 tsp vanilla extract',
                    '2 cups chocolate chips'
                ],
                instructions: [
                    'Preheat oven to 375¬∞F (190¬∞C)',
                    'Mix flour, baking soda, and salt in a bowl',
                    'Cream butter and sugars until fluffy',
                    'Beat in eggs and vanilla',
                    'Gradually blend in flour mixture',
                    'Stir in chocolate chips',
                    'Drop rounded tablespoons onto ungreased cookie sheets',
                    'Bake 9-11 minutes until golden brown'
                ]
            }
        ];

        let currentFilter = 'all';
        let currentRecipeId = null;

        // DOM Elements
        const recipesGrid = document.getElementById('recipesGrid');
        const searchInput = document.getElementById('searchInput');
        const recipeModal = document.getElementById('recipeModal');
        const addRecipeModal = document.getElementById('addRecipeModal');
        const recipeForm = document.getElementById('recipeForm');

        // Initialize app
        document.addEventListener('DOMContentLoaded', () => {
            renderRecipes();
            setupEventListeners();
        });

        // Setup event listeners
        function setupEventListeners() {
            searchInput.addEventListener('input', handleSearch);
            recipeForm.addEventListener('submit', handleAddRecipe);
        }

        // Render recipes
        function renderRecipes(recipesToRender = recipes) {
            if (recipesToRender.length === 0) {
                recipesGrid.innerHTML = '<p style="text-align: center; color: white; font-size: 1.2rem; grid-column: 1/-1;">No recipes found. Try a different search or category.</p>';
                return;
            }
            recipesGrid.innerHTML = recipesToRender.map(recipe => `
                <div class="recipe-card" onclick="showRecipeDetail(${recipe.id}, event)">
                    <img src="${recipe.image}" alt="${recipe.name}" class="recipe-image" 
                         onerror="this.src='https://via.placeholder.com/600x400/f0f0f0/999?text=Recipe+Image'">
                    <div class="recipe-info">
                        <h3 class="recipe-title">${recipe.name}</h3>
                        <div class="recipe-meta">
                            <span class="meta-item">‚è±Ô∏è ${recipe.time}</span>
                            <span class="meta-item difficulty-${recipe.difficulty.toLowerCase()}">${getDifficultyIcon(recipe.difficulty)} ${recipe.difficulty}</span>
                            <span class="meta-item">üë• ${recipe.servings} servings</span>
                        </div>
                        <p class="recipe-preview">${recipe.ingredients.slice(0, 3).join(', ')}...</p>
                    </div>
                </div>
            `).join('');
        }

        // Get difficulty icon
        function getDifficultyIcon(difficulty) {
            const icons = { Easy: 'üü¢', Medium: 'üü°', Hard: 'üî¥' };
            return icons[difficulty] || '‚ö™';
        }

        // Filter recipes by category
        function filterRecipes(category) {
            currentFilter = category;
            
            // Update active button
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Filter and render
            const filtered = category === 'all' ? recipes : recipes.filter(r => r.category === category);
            renderRecipes(filtered);
        }

        // Handle search
        function handleSearch() {
            const query = searchInput.value.toLowerCase();
            const filtered = recipes.filter(recipe => 
                recipe.name.toLowerCase().includes(query) ||
                recipe.ingredients.some(ing => ing.toLowerCase().includes(query)) ||
                recipe.category.toLowerCase().includes(query)
            );
            
            // Apply category filter if active
            const finalFiltered = currentFilter === 'all' ? filtered : 
                filtered.filter(r => r.category === currentFilter);
            
            renderRecipes(finalFiltered);
        }

        // Show recipe detail modal
        function showRecipeDetail(recipeId, event) {
            const recipe = recipes.find(r => r.id === recipeId);
            if (!recipe) return;
            
            currentRecipeId = recipeId;
            
            // Position modal at current scroll position
            const modalContent = recipeModal.querySelector('.modal-content');
            modalContent.style.top = window.scrollY + 50 + 'px';
            
            document.getElementById('modalImage').src = recipe.image;
            document.getElementById('modalTitle').textContent = recipe.name;
            document.getElementById('modalTime').innerHTML = `‚è±Ô∏è ${recipe.time}`;
            document.getElementById('modalDifficulty').innerHTML = `${getDifficultyIcon(recipe.difficulty)} ${recipe.difficulty}`;
            document.getElementById('modalServings').innerHTML = `üë• ${recipe.servings} servings`;
            
            document.getElementById('modalIngredients').innerHTML = recipe.ingredients
                .map(ing => `<li>${ing}</li>`).join('');
            
            document.getElementById('modalInstructions').innerHTML = recipe.instructions
                .map(inst => `<li>${inst}</li>`).join('');
            
            recipeModal.style.display = 'block';
        }

        // Edit recipe function
        function editRecipe() {
            if (!currentRecipeId) return;
            
            const recipe = recipes.find(r => r.id === currentRecipeId);
            if (!recipe) return;
            
            // Populate edit form with current recipe data
            document.getElementById('recipeName').value = recipe.name;
            document.getElementById('recipeCategory').value = recipe.category;
            document.getElementById('recipeTime').value = recipe.time;
            document.getElementById('recipeDifficulty').value = recipe.difficulty;
            document.getElementById('recipeServings').value = recipe.servings;
            document.getElementById('recipeImage').value = recipe.image;
            document.getElementById('recipeIngredients').value = recipe.ingredients.join('\n');
            document.getElementById('recipeInstructions').value = recipe.instructions.join('\n');
            
            // Close recipe modal and show edit modal
            closeRecipeModal();
            showAddRecipe();
            
            // Change form title and button text
            document.querySelector('.add-recipe-form h2').textContent = 'Edit Recipe';
            document.querySelector('.submit-btn').textContent = 'Update Recipe';
        }

        // Delete recipe function
        function deleteRecipe() {
            if (!currentRecipeId) return;
            
            if (confirm('Are you sure you want to delete this recipe? This action cannot be undone.')) {
                recipes = recipes.filter(r => r.id !== currentRecipeId);
                saveRecipes();
                renderRecipes();
                closeRecipeModal();
                currentRecipeId = null;
            }
        }

        // Show add recipe modal
        function showAddRecipe() {
            // Position modal at current scroll position
            const modalContent = addRecipeModal.querySelector('.modal-content');
            modalContent.style.top = window.scrollY + 50 + 'px';
            
            addRecipeModal.style.display = 'block';
        }

        // Close recipe modal
        function closeRecipeModal() {
            recipeModal.style.display = 'none';
            currentRecipeId = null;
        }

        // Hide add recipe modal
        function hideAddRecipe() {
            addRecipeModal.style.display = 'none';
            recipeForm.reset();
            currentRecipeId = null;
            
            // Reset form title and button text
            document.querySelector('.add-recipe-form h2').textContent = 'Create New Recipe';
            document.querySelector('.submit-btn').textContent = 'Create Recipe';
            
            // Hide image preview
            document.getElementById('imagePreview').style.display = 'none';
        }

        // Handle image upload
        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const imageData = e.target.result;
                    document.getElementById('recipeImage').value = imageData;
                    
                    // Show preview
                    const preview = document.getElementById('imagePreview');
                    const previewImg = document.getElementById('previewImg');
                    previewImg.src = imageData;
                    preview.style.display = 'block';
                };
                reader.readAsDataURL(file);
            }
        }

        // Handle add recipe form submission
        function handleAddRecipe(e) {
            e.preventDefault();
            
            const isEditing = currentRecipeId !== null;
            const imageValue = document.getElementById('recipeImage').value || 'https://via.placeholder.com/600x400/f0f0f0/999?text=Recipe+Image';
            
            if (isEditing) {
                // Update existing recipe
                const recipeIndex = recipes.findIndex(r => r.id === currentRecipeId);
                if (recipeIndex !== -1) {
                    recipes[recipeIndex] = {
                        ...recipes[recipeIndex],
                        name: document.getElementById('recipeName').value,
                        category: document.getElementById('recipeCategory').value,
                        time: document.getElementById('recipeTime').value,
                        difficulty: document.getElementById('recipeDifficulty').value,
                        servings: parseInt(document.getElementById('recipeServings').value),
                        image: imageValue,
                        ingredients: document.getElementById('recipeIngredients').value.split('\n').filter(ing => ing.trim()),
                        instructions: document.getElementById('recipeInstructions').value.split('\n').filter(inst => inst.trim())
                    };
                }
            } else {
                // Add new recipe
                const newRecipe = {
                    id: Date.now(),
                    name: document.getElementById('recipeName').value,
                    category: document.getElementById('recipeCategory').value,
                    time: document.getElementById('recipeTime').value,
                    difficulty: document.getElementById('recipeDifficulty').value,
                    servings: parseInt(document.getElementById('recipeServings').value),
                    image: imageValue,
                    ingredients: document.getElementById('recipeIngredients').value.split('\n').filter(ing => ing.trim()),
                    instructions: document.getElementById('recipeInstructions').value.split('\n').filter(inst => inst.trim())
                };
                
                recipes.unshift(newRecipe);
            }
            
            saveRecipes();
            renderRecipes();
            hideAddRecipe();
        }

        // Save recipes to localStorage
        function saveRecipes() {
            localStorage.setItem('recipes', JSON.stringify(recipes));
        }
    </script>
</body>
</html>
